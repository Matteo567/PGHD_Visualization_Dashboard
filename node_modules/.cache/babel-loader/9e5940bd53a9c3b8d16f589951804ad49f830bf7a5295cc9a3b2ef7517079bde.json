{"ast":null,"code":"/*\r\n usePatientData.js - Patient Data Management Hook\r\n \r\n This custom hook manages all patient data operations including fetching and caching\r\n patient data from CSV files, providing loading, error, and data states, handling\r\n data validation and error recovery, and offering convenient access to individual\r\n health metric datasets.\r\n \r\n Architecture:\r\n - Uses React hooks for state management (useState, useEffect, useCallback)\r\n - Implements data caching to optimize performance\r\n - Provides comprehensive error handling and recovery\r\n - Offers convenient data access patterns for components\r\n \r\n State Management:\r\n - data: The complete patient data object\r\n - loading: Boolean indicating if data is being fetched\r\n - error: Error message if data fetching failed\r\n - lastFetchedId: Tracks the last patient ID to prevent unnecessary re-fetching\r\n \r\n Data Structure:\r\n - patientInfo: Patient demographics and medical information\r\n - glucoseData: Blood glucose readings with timestamps and ranges\r\n - bloodPressureData: Blood pressure measurements with systolic/diastolic values\r\n - exerciseData: Physical activity tracking with duration and type\r\n - moodData: Daily mood assessments\r\n - painData: Pain reports with location and intensity\r\n - sleepData: Sleep duration and quality measurements\r\n - mealData: Nutritional intake tracking\r\n \r\n Utility Functions:\r\n - refetch: Forces a fresh data fetch for the current patient\r\n - clearData: Clears all cached data and resets state\r\n - hasData: Boolean indicating if data is available\r\n - isEmpty: Boolean indicating if no data is available and not loading\r\n - isError: Boolean indicating if an error occurred\r\n */import{useState,useEffect,useCallback}from'react';import DataService from'../services/dataService';/*\r\n Enhanced custom hook for loading and managing patient data\r\n \r\n - @param {string} patientId - The patient identifier\r\n - @returns {Object} Object containing data, loading state, error state, and utility functions\r\n */const usePatientData=patientId=>{const[data,setData]=useState(null);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[lastFetchedId,setLastFetchedId]=useState(null);const loadData=useCallback(async id=>{// Don't reload if we already have data for this patient\nif(id===lastFetchedId&&data&&!error){return;}if(!id||typeof id!=='string'){setLoading(false);setData(null);setError(null);return;}try{setLoading(true);setError(null);const patientData=await DataService.getPatientData(id);if(patientData&&patientData.patientInfo){setData(patientData);setLastFetchedId(id);}else{throw new Error('Invalid data structure received');}}catch(err){const errorMessage=err instanceof Error?err.message:'Unknown error occurred';setError(errorMessage);setData(null);console.error('Error loading patient data:',err);}finally{setLoading(false);}},[lastFetchedId,data,error]);useEffect(()=>{if(patientId){loadData(patientId);}else{setData(null);setError(null);setLastFetchedId(null);setLoading(false);}},[patientId,loadData]);const refetch=useCallback(()=>{if(patientId){setLastFetchedId(null);// Force reload\nloadData(patientId);}},[patientId,loadData]);const clearData=useCallback(()=>{setData(null);setError(null);setLastFetchedId(null);setLoading(false);},[]);return{// Core data\ndata,loading,error,// Patient info\npatientInfo:(data===null||data===void 0?void 0:data.patientInfo)||null,// Individual data types for convenience\nglucoseData:(data===null||data===void 0?void 0:data.glucoseData)||[],bloodPressureData:(data===null||data===void 0?void 0:data.bloodPressureData)||[],exerciseData:(data===null||data===void 0?void 0:data.exerciseData)||[],moodData:(data===null||data===void 0?void 0:data.moodData)||[],painData:(data===null||data===void 0?void 0:data.painData)||[],mealData:(data===null||data===void 0?void 0:data.mealData)||[],sleepData:(data===null||data===void 0?void 0:data.sleepData)||[],// Actions\nrefetch,clearData,// Helper flags\nhasData:!!data,isEmpty:!loading&&!error&&!data,isError:!!error,// Data availability flags\nhasGlucoseData:((data===null||data===void 0?void 0:data.glucoseData)||[]).length>0,hasBloodPressureData:((data===null||data===void 0?void 0:data.bloodPressureData)||[]).length>0,hasExerciseData:((data===null||data===void 0?void 0:data.exerciseData)||[]).length>0,hasMoodData:((data===null||data===void 0?void 0:data.moodData)||[]).length>0,hasPainData:((data===null||data===void 0?void 0:data.painData)||[]).length>0,hasSleepData:((data===null||data===void 0?void 0:data.sleepData)||[]).length>0,hasMealData:((data===null||data===void 0?void 0:data.mealData)||[]).length>0};};export default usePatientData;","map":{"version":3,"names":["useState","useEffect","useCallback","DataService","usePatientData","patientId","data","setData","loading","setLoading","error","setError","lastFetchedId","setLastFetchedId","loadData","id","patientData","getPatientData","patientInfo","Error","err","errorMessage","message","console","refetch","clearData","glucoseData","bloodPressureData","exerciseData","moodData","painData","mealData","sleepData","hasData","isEmpty","isError","hasGlucoseData","length","hasBloodPressureData","hasExerciseData","hasMoodData","hasPainData","hasSleepData","hasMealData"],"sources":["C:/Users/Matteo/Working_Folder/a. MCC Thesis Local/Health_data_dashboard-MCC_project_checkpoint/src/hooks/usePatientData.js"],"sourcesContent":["/*\r\n usePatientData.js - Patient Data Management Hook\r\n \r\n This custom hook manages all patient data operations including fetching and caching\r\n patient data from CSV files, providing loading, error, and data states, handling\r\n data validation and error recovery, and offering convenient access to individual\r\n health metric datasets.\r\n \r\n Architecture:\r\n - Uses React hooks for state management (useState, useEffect, useCallback)\r\n - Implements data caching to optimize performance\r\n - Provides comprehensive error handling and recovery\r\n - Offers convenient data access patterns for components\r\n \r\n State Management:\r\n - data: The complete patient data object\r\n - loading: Boolean indicating if data is being fetched\r\n - error: Error message if data fetching failed\r\n - lastFetchedId: Tracks the last patient ID to prevent unnecessary re-fetching\r\n \r\n Data Structure:\r\n - patientInfo: Patient demographics and medical information\r\n - glucoseData: Blood glucose readings with timestamps and ranges\r\n - bloodPressureData: Blood pressure measurements with systolic/diastolic values\r\n - exerciseData: Physical activity tracking with duration and type\r\n - moodData: Daily mood assessments\r\n - painData: Pain reports with location and intensity\r\n - sleepData: Sleep duration and quality measurements\r\n - mealData: Nutritional intake tracking\r\n \r\n Utility Functions:\r\n - refetch: Forces a fresh data fetch for the current patient\r\n - clearData: Clears all cached data and resets state\r\n - hasData: Boolean indicating if data is available\r\n - isEmpty: Boolean indicating if no data is available and not loading\r\n - isError: Boolean indicating if an error occurred\r\n */\r\n\r\nimport { useState, useEffect, useCallback } from 'react';\r\nimport DataService from '../services/dataService';\r\n\r\n/*\r\n Enhanced custom hook for loading and managing patient data\r\n \r\n - @param {string} patientId - The patient identifier\r\n - @returns {Object} Object containing data, loading state, error state, and utility functions\r\n */\r\nconst usePatientData = (patientId) => {\r\n  const [data, setData] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState(null);\r\n  const [lastFetchedId, setLastFetchedId] = useState(null);\r\n\r\n  const loadData = useCallback(async (id) => {\r\n    // Don't reload if we already have data for this patient\r\n    if (id === lastFetchedId && data && !error) {\r\n      return;\r\n    }\r\n\r\n    if (!id || typeof id !== 'string') {\r\n      setLoading(false);\r\n      setData(null);\r\n      setError(null);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      const patientData = await DataService.getPatientData(id);\r\n      \r\n      if (patientData && patientData.patientInfo) {\r\n        setData(patientData);\r\n        setLastFetchedId(id);\r\n      } else {\r\n        throw new Error('Invalid data structure received');\r\n      }\r\n    } catch (err) {\r\n      const errorMessage = err instanceof Error ? err.message : 'Unknown error occurred';\r\n      setError(errorMessage);\r\n      setData(null);\r\n      console.error('Error loading patient data:', err);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [lastFetchedId, data, error]);\r\n\r\n  useEffect(() => {\r\n    if (patientId) {\r\n      loadData(patientId);\r\n    } else {\r\n      setData(null);\r\n      setError(null);\r\n      setLastFetchedId(null);\r\n      setLoading(false);\r\n    }\r\n  }, [patientId, loadData]);\r\n\r\n  const refetch = useCallback(() => {\r\n    if (patientId) {\r\n      setLastFetchedId(null); // Force reload\r\n      loadData(patientId);\r\n    }\r\n  }, [patientId, loadData]);\r\n\r\n  const clearData = useCallback(() => {\r\n    setData(null);\r\n    setError(null);\r\n    setLastFetchedId(null);\r\n    setLoading(false);\r\n  }, []);\r\n\r\n  return {\r\n    // Core data\r\n    data,\r\n    loading,\r\n    error,\r\n    \r\n    // Patient info\r\n    patientInfo: data?.patientInfo || null,\r\n    \r\n    // Individual data types for convenience\r\n    glucoseData: data?.glucoseData || [],\r\n    bloodPressureData: data?.bloodPressureData || [],\r\n    exerciseData: data?.exerciseData || [],\r\n    moodData: data?.moodData || [],\r\n    painData: data?.painData || [],\r\n    mealData: data?.mealData || [],\r\n    sleepData: data?.sleepData || [],\r\n    \r\n    // Actions\r\n    refetch,\r\n    clearData,\r\n    \r\n    // Helper flags\r\n    hasData: !!data,\r\n    isEmpty: !loading && !error && !data,\r\n    isError: !!error,\r\n    \r\n    // Data availability flags\r\n    hasGlucoseData: (data?.glucoseData || []).length > 0,\r\n    hasBloodPressureData: (data?.bloodPressureData || []).length > 0,\r\n    hasExerciseData: (data?.exerciseData || []).length > 0,\r\n    hasMoodData: (data?.moodData || []).length > 0,\r\n    hasPainData: (data?.painData || []).length > 0,\r\n    hasSleepData: (data?.sleepData || []).length > 0,\r\n    hasMealData: (data?.mealData || []).length > 0\r\n  };\r\n};\r\n\r\nexport default usePatientData;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}