{"ast":null,"code":"/*\n BloodPressureChart.js - Blood Pressure Monitoring Visualization\n \n This component provides comprehensive blood pressure tracking:\n - Systolic and diastolic pressure visualization\n - Risk categorization with color coding\n - Daily and weekly trend analysis\n - Multiple daily measurements display\n - Interactive tooltips with BP details\n - Navigation controls for time periods\n \n ARCHITECTURE:\n - Uses custom SVG for precise blood pressure visualization\n - Implements dual-axis system for systolic and diastolic values\n - Provides risk-based color coding for clinical interpretation\n - Supports multiple daily readings with time-based positioning\n - Implements configurable layouts\n \n Visualization Features:\n - Dual-line chart showing systolic and diastolic trends\n - Color-coded risk categories (normal, elevated, high, crisis)\n - Time-based positioning for multiple daily readings\n - Interactive tooltips with detailed BP information\n - Grid system with proper axis scaling\n \n Clinical Features:\n - Risk categorization based on medical guidelines\n - Summary statistics for physician view\n - Trend analysis over time periods\n - Educational information for patient view\n \n Component Structure:\n - Y-Axis: Dual-axis system for systolic and diastolic values\n - X-Axis: Time-based axis with day and time labels\n - DataPoints: Interactive blood pressure readings\n - Legend: Risk category explanations\n - Tooltip: Detailed reading information\n \n Critical for cardiovascular health monitoring and hypertension management.\n */import React,{useState,useRef,useLayoutEffect}from'react';import usePatientData from'../../hooks/usePatientData';import useChartNavigation from'../../hooks/useChartNavigation';import Legend from'../Legend';import InfoBox from'../InfoBox';import Tooltip from'../ui/Tooltip';import'./BloodPressureChart.css';// Constants\nimport{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TIME_LABELS=['12a','12p','12a'];const TIME_HOURS=[0,12,24];// Helper Functions\nconst getWeekStart=date=>{const d=new Date(date);const day=d.getDay();const diff=d.getDate()-day;return new Date(d.setDate(diff));};const formatDayLabel=date=>{const dayNames=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];return dayNames[date.getDay()];};const getTimePosition=(date,dayIndex,config)=>{const hour=date.getHours()+date.getMinutes()/60;const timeRatio=hour/24;const dayContentWidth=config.dayWidth-config.dayPadding*2;return config.padding.left+dayIndex*config.dayWidth+config.dayPadding+timeRatio*dayContentWidth;};// Chart Sub-components\nconst YAxis=_ref=>{let{config,type}=_ref;const chartHeight=config.height-config.padding.top-config.padding.bottom;const yAxisLabels=config.yAxisLabels[type];const valueRange=config.yAxisRange[type];const yOffset=config.yAxisOffset[type];return/*#__PURE__*/_jsxs(\"g\",{className:\"y-axis\",children:[/*#__PURE__*/_jsx(\"text\",{x:config.padding.left/3,y:config.padding.top+chartHeight/2,fontSize:config.fontSize.yAxisTitle,textAnchor:\"middle\",className:\"y-axis-title\",transform:\"rotate(-90, \".concat(config.padding.left/3,\", \").concat(config.padding.top+chartHeight/2,\")\"),children:\"mm Hg\"}),yAxisLabels.map(value=>{const y=config.height-config.padding.bottom-(value-yOffset)/valueRange*chartHeight;return/*#__PURE__*/_jsxs(\"g\",{className:\"y-axis-grid-group\",children:[/*#__PURE__*/_jsx(\"line\",{className:\"chart-grid-line-horizontal\",x1:config.padding.left,y1:y,x2:config.width-config.padding.right,y2:y}),/*#__PURE__*/_jsx(\"text\",{x:config.padding.left-10,y:y+3,fontSize:config.fontSize.yAxis,textAnchor:\"end\",className:\"chart-tick-label\",children:value})]},value);})]});};// Blood Pressure Range Background Component\nconst BPRangeBackground=_ref2=>{let{config}=_ref2;const chartHeight=config.height-config.padding.top-config.padding.bottom;const systolicRange=config.yAxisRange.systolic;const diastolicRange=config.yAxisRange.diastolic;const systolicOffset=config.yAxisOffset.systolic;const diastolicOffset=config.yAxisOffset.diastolic;// Define BP ranges (systolic/diastolic)\nconst ranges=[{name:'High',systolic:[140,200],diastolic:[90,120],color:'var(--chart-color-orange)',opacity:0.1},{name:'Pre-high',systolic:[120,140],diastolic:[80,90],color:'var(--chart-color-yellow)',opacity:0.1},{name:'Ideal',systolic:[90,120],diastolic:[60,80],color:'var(--chart-color-blue)',opacity:0.1},{name:'Low',systolic:[0,90],diastolic:[0,60],color:'var(--chart-color-danger)',opacity:0.1}];return/*#__PURE__*/_jsx(\"g\",{className:\"bp-range-background\",children:ranges.map((range,index)=>{// Calculate Y positions for systolic range\nconst systolicTopY=config.height-config.padding.bottom-(range.systolic[1]-systolicOffset)/systolicRange*chartHeight;const systolicBottomY=config.height-config.padding.bottom-(range.systolic[0]-systolicOffset)/systolicRange*chartHeight;// Calculate Y positions for diastolic range  \nconst diastolicTopY=config.height-config.padding.bottom-(range.diastolic[1]-diastolicOffset)/diastolicRange*chartHeight;const diastolicBottomY=config.height-config.padding.bottom-(range.diastolic[0]-diastolicOffset)/diastolicRange*chartHeight;// Create overlapping rectangles for the range\nreturn/*#__PURE__*/_jsxs(\"g\",{children:[/*#__PURE__*/_jsx(\"rect\",{x:config.padding.left,y:Math.min(systolicTopY,systolicBottomY),width:config.width-config.padding.left-config.padding.right,height:Math.abs(systolicBottomY-systolicTopY),fill:range.color,opacity:range.opacity,className:\"bp-range-\".concat(range.name.toLowerCase())}),/*#__PURE__*/_jsx(\"rect\",{x:config.padding.left,y:Math.min(diastolicTopY,diastolicBottomY),width:config.width-config.padding.left-config.padding.right,height:Math.abs(diastolicBottomY-diastolicTopY),fill:range.color,opacity:range.opacity,className:\"bp-range-\".concat(range.name.toLowerCase())})]},range.name);})});};// New Dual Y-Axis Component for Combined Chart\nconst DualYAxis=_ref3=>{let{config}=_ref3;const chartHeight=config.height-config.padding.top-config.padding.bottom;const systolicLabels=config.yAxisLabels.systolic;const diastolicLabels=config.yAxisLabels.diastolic;const systolicRange=config.yAxisRange.systolic;const diastolicRange=config.yAxisRange.diastolic;const systolicOffset=config.yAxisOffset.systolic;const diastolicOffset=config.yAxisOffset.diastolic;return/*#__PURE__*/_jsxs(\"g\",{className:\"dual-y-axis\",children:[/*#__PURE__*/_jsxs(\"g\",{className:\"y-axis-left\",children:[/*#__PURE__*/_jsx(\"text\",{x:config.padding.left/3,y:config.padding.top+chartHeight/2,fontSize:config.fontSize.yAxisTitle,textAnchor:\"middle\",className:\"y-axis-title\",transform:\"rotate(-90, \".concat(config.padding.left/3,\", \").concat(config.padding.top+chartHeight/2,\")\"),children:\"Systolic (mmHg)\"}),systolicLabels.map(value=>{const y=config.height-config.padding.bottom-(value-systolicOffset)/systolicRange*chartHeight;return/*#__PURE__*/_jsxs(\"g\",{className:\"y-axis-grid-group\",children:[/*#__PURE__*/_jsx(\"line\",{className:\"chart-grid-line-horizontal\",x1:config.padding.left,y1:y,x2:config.width-config.padding.right,y2:y}),/*#__PURE__*/_jsx(\"text\",{x:config.padding.left-10,y:y+3,fontSize:config.fontSize.yAxis,textAnchor:\"end\",className:\"chart-tick-label systolic-label\",fill:\"black\",children:value})]},\"systolic-\".concat(value));})]}),/*#__PURE__*/_jsxs(\"g\",{className:\"y-axis-right\",children:[/*#__PURE__*/_jsx(\"text\",{x:config.width-config.padding.right/3,y:config.padding.top+chartHeight/2,fontSize:config.fontSize.yAxisTitle,textAnchor:\"middle\",className:\"y-axis-title\",transform:\"rotate(90, \".concat(config.width-config.padding.right/3,\", \").concat(config.padding.top+chartHeight/2,\")\"),children:\"Diastolic (mmHg)\"}),diastolicLabels.map(value=>{const y=config.height-config.padding.bottom-(value-diastolicOffset)/diastolicRange*chartHeight;return/*#__PURE__*/_jsx(\"g\",{className:\"y-axis-grid-group\",children:/*#__PURE__*/_jsx(\"text\",{x:config.width-config.padding.right+10,y:y+3,fontSize:config.fontSize.yAxis,textAnchor:\"start\",className:\"chart-tick-label diastolic-label\",fill:\"var(--chart-color-green)\",children:value})},\"diastolic-\".concat(value));})]})]});};const XAxis=_ref4=>{let{config,weekDays}=_ref4;return/*#__PURE__*/_jsxs(\"g\",{className:\"x-axis\",children:[weekDays.map((day,dayIndex)=>{const dayX=config.padding.left+dayIndex*config.dayWidth;const dayCenterX=dayX+config.dayWidth/2;// Tick positions\nconst startTickX=dayX;const middleTickX=dayX+config.dayWidth/2;return/*#__PURE__*/_jsxs(\"g\",{className:\"x-axis-label-group\",children:[/*#__PURE__*/_jsx(\"line\",{className:\"x-axis-tick\",x1:startTickX,y1:config.height-config.padding.bottom,x2:startTickX,y2:config.height-config.padding.bottom+5,stroke:\"var(--chart-color-neutral)\",strokeWidth:\"1\"}),/*#__PURE__*/_jsx(\"line\",{className:\"x-axis-tick\",x1:middleTickX,y1:config.height-config.padding.bottom,x2:middleTickX,y2:config.height-config.padding.bottom+5,stroke:\"var(--chart-color-neutral)\",strokeWidth:\"1\"}),/*#__PURE__*/_jsx(\"text\",{className:\"time-label\",x:startTickX,y:config.height-config.padding.bottom+15,textAnchor:\"middle\",fontSize:config.fontSize.timeLabel,style:{fontSize:'8px'},children:\"12a\"}),/*#__PURE__*/_jsx(\"text\",{className:\"time-label\",x:middleTickX,y:config.height-config.padding.bottom+15,textAnchor:\"middle\",fontSize:config.fontSize.timeLabel,style:{fontSize:'8px'},children:\"12p\"}),/*#__PURE__*/_jsx(\"text\",{x:dayCenterX,y:config.height-config.padding.bottom+35,textAnchor:\"middle\",className:\"x-axis-day-label\",fontSize:config.fontSize.dayLabel,style:{fontSize:'8px'},children:formatDayLabel(day)}),/*#__PURE__*/_jsx(\"text\",{x:dayCenterX,y:config.height-config.padding.bottom+52,textAnchor:\"middle\",className:\"x-axis-date-label\",fontSize:config.fontSize.dateLabel,style:{fontSize:'8px'},children:day.getDate()})]},dayIndex);}),/*#__PURE__*/_jsx(\"line\",{className:\"x-axis-tick\",x1:config.padding.left+weekDays.length*config.dayWidth,y1:config.height-config.padding.bottom,x2:config.padding.left+weekDays.length*config.dayWidth,y2:config.height-config.padding.bottom+5,stroke:\"var(--chart-color-neutral)\",strokeWidth:\"1\"}),/*#__PURE__*/_jsx(\"text\",{className:\"time-label\",x:config.padding.left+weekDays.length*config.dayWidth,y:config.height-config.padding.bottom+15,textAnchor:\"middle\",fontSize:config.fontSize.timeLabel,style:{fontSize:'8px'},children:\"12a\"})]});};const GridLines=_ref5=>{let{config,weekDays}=_ref5;return/*#__PURE__*/_jsxs(\"g\",{className:\"grid-lines\",children:[weekDays.map((_,dayIndex)=>{const dayX=config.padding.left+dayIndex*config.dayWidth;return/*#__PURE__*/_jsxs(\"g\",{children:[/*#__PURE__*/_jsx(\"line\",{className:\"chart-grid-line-vertical\",x1:dayX,y1:config.padding.top,x2:dayX,y2:config.height-config.padding.bottom}),[0,12].map(hour=>{const timeRatio=hour/24;const x=config.padding.left+dayIndex*config.dayWidth+timeRatio*config.dayWidth;return/*#__PURE__*/_jsx(\"line\",{className:\"chart-grid-line-vertical-time\",x1:x,y1:config.padding.top,x2:x,y2:config.height-config.padding.bottom},\"\".concat(dayIndex,\"-\").concat(hour));})]},dayIndex);}),/*#__PURE__*/_jsx(\"line\",{className:\"chart-grid-line-vertical\",x1:config.padding.left+weekDays.length*config.dayWidth,y1:config.padding.top,x2:config.padding.left+weekDays.length*config.dayWidth,y2:config.height-config.padding.bottom})]});};const DataBars=_ref6=>{let{readings,type,config,onBarHover,onBarLeave}=_ref6;const chartHeight=config.height-config.padding.top-config.padding.bottom;const valueRange=config.yAxisRange[type];const yOffset=config.yAxisOffset[type];const getColor=type==='systolic'?getSystolicColor:getDiastolicColor;return/*#__PURE__*/_jsx(\"g\",{className:\"data-bars\",children:readings.map((reading,index)=>{const readingDate=new Date(reading.date);const dayIndex=readingDate.getDay();const x=getTimePosition(readingDate,dayIndex,config);const value=reading[type];const barHeight=value/valueRange*chartHeight;const y=config.height-config.padding.bottom-barHeight;const handleMouseEnter=event=>{const tooltipData={type:type==='systolic'?'Systolic':'Diastolic',value:value,unit:'mmHg',time:readingDate.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit',hour12:true}),date:readingDate.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'}),position:{x:event.clientX,y:event.clientY}};onBarHover(tooltipData);};const handleMouseLeave=()=>{onBarLeave();};return/*#__PURE__*/_jsx(\"rect\",{x:x-config.barWidth/2,y:y,width:config.barWidth,height:Math.max(0,barHeight),fill:getColor(value),style:{cursor:'pointer'},onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave},index);})});};// New Combined I-Bar Chart Component\nconst CombinedDataBars=_ref7=>{let{readings,config,onBarHover,onBarLeave}=_ref7;const chartHeight=config.height-config.padding.top-config.padding.bottom;const systolicRange=config.yAxisRange.systolic;const diastolicRange=config.yAxisRange.diastolic;const systolicOffset=config.yAxisOffset.systolic;const diastolicOffset=config.yAxisOffset.diastolic;return/*#__PURE__*/_jsx(\"g\",{className:\"combined-data-bars\",children:readings.map((reading,index)=>{const readingDate=new Date(reading.date);const dayIndex=readingDate.getDay();const x=getTimePosition(readingDate,dayIndex,config);// Calculate positions for both systolic and diastolic\nconst systolicValue=reading.systolic;const diastolicValue=reading.diastolic;const systolicBarHeight=systolicValue/systolicRange*chartHeight;const diastolicBarHeight=diastolicValue/diastolicRange*chartHeight;const systolicY=config.height-config.padding.bottom-systolicBarHeight;const diastolicY=config.height-config.padding.bottom-diastolicBarHeight;// Determine overall risk color based on both values\nconst getCombinedRiskColor=(systolic,diastolic)=>{if(systolic>=140||diastolic>=90)return'var(--chart-color-orange)';// High\nif(systolic>=120||diastolic>=80)return'var(--chart-color-yellow)';// Pre-high\nif(systolic<90||diastolic<60)return'var(--chart-color-danger)';// Low\nreturn'var(--chart-color-blue)';// Ideal\n};const riskColor=getCombinedRiskColor(systolicValue,diastolicValue);const handleMouseEnter=event=>{const tooltipData={type:'Blood Pressure',systolic:systolicValue,diastolic:diastolicValue,unit:'mmHg',time:readingDate.toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit',hour12:true}),date:readingDate.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'}),position:{x:event.clientX,y:event.clientY}};onBarHover(tooltipData);};const handleMouseLeave=()=>{onBarLeave();};return/*#__PURE__*/_jsxs(\"g\",{className:\"bp-reading-group\",children:[/*#__PURE__*/_jsx(\"line\",{x1:x,y1:systolicY,x2:x,y2:diastolicY,stroke:riskColor,strokeWidth:\"3\",style:{cursor:'pointer'},onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave}),/*#__PURE__*/_jsx(\"circle\",{cx:x,cy:systolicY,r:\"4\",fill:riskColor,style:{cursor:'pointer'},onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave}),/*#__PURE__*/_jsx(\"circle\",{cx:x,cy:diastolicY,r:\"4\",fill:riskColor,style:{cursor:'pointer'},onMouseEnter:handleMouseEnter,onMouseLeave:handleMouseLeave})]},index);})});};const Chart=_ref8=>{let{type,weekData,isExpanded,weekDays,containerWidth,onBarHover,onBarLeave}=_ref8;// Simple inline config - no factory pattern needed\nconst config=isExpanded?{width:700,height:550,padding:{top:80,right:60,bottom:100,left:80},dayWidth:80,fontSize:{yAxis:16,yAxisTitle:18,timeLabel:14,dayLabel:14,dateLabel:14},barWidth:12,yAxisRange:{systolic:200,diastolic:120},yAxisOffset:{systolic:0,diastolic:0},yAxisLabels:{systolic:[0,40,80,120,160,200],diastolic:[0,20,40,60,80,100,120]},dayPadding:10}:{width:450,height:350,padding:{top:60,right:40,bottom:80,left:60},dayWidth:50,fontSize:{yAxis:14,yAxisTitle:16,timeLabel:12,dayLabel:12,dateLabel:12},barWidth:8,yAxisRange:{systolic:200,diastolic:120},yAxisOffset:{systolic:0,diastolic:0},yAxisLabels:{systolic:[0,100,200],diastolic:[0,60,120]},dayPadding:6};const readings=weekData.filter(d=>d[type]&&d[type]>0);return/*#__PURE__*/_jsxs(\"div\",{className:\"chart-section \".concat(isExpanded?'expanded':''),children:[/*#__PURE__*/_jsx(\"h4\",{className:\"chart-subtitle\",children:type==='systolic'?'Systolic':'Diastolic'}),/*#__PURE__*/_jsx(\"div\",{className:\"bp-svg-container\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"100%\",height:\"100%\",viewBox:\"0 0 \".concat(config.width,\" \").concat(config.height),className:\"chart-svg\",children:[/*#__PURE__*/_jsx(GridLines,{config:config,weekDays:weekDays}),/*#__PURE__*/_jsx(YAxis,{config:config,type:type}),/*#__PURE__*/_jsx(XAxis,{config:config,weekDays:weekDays}),/*#__PURE__*/_jsx(DataBars,{readings:readings,type:type,config:config,onBarHover:onBarHover,onBarLeave:onBarLeave})]})})]});};// New Combined Chart Component\nconst CombinedChart=_ref9=>{let{weekData,isExpanded,weekDays,containerWidth,onBarHover,onBarLeave}=_ref9;// Simple inline config - no factory pattern needed\nconst config=isExpanded?{width:700,height:550,padding:{top:80,right:60,bottom:100,left:80},dayWidth:80,fontSize:{yAxis:16,yAxisTitle:18,timeLabel:14,dayLabel:14,dateLabel:14},barWidth:12,yAxisRange:{systolic:200,diastolic:120},yAxisOffset:{systolic:0,diastolic:0},yAxisLabels:{systolic:[0,40,80,120,160,200],diastolic:[0,20,40,60,80,100,120]},dayPadding:10}:{width:450,height:350,padding:{top:60,right:40,bottom:80,left:60},dayWidth:50,fontSize:{yAxis:14,yAxisTitle:16,timeLabel:12,dayLabel:12,dateLabel:12},barWidth:8,yAxisRange:{systolic:200,diastolic:120},yAxisOffset:{systolic:0,diastolic:0},yAxisLabels:{systolic:[0,100,200],diastolic:[0,60,120]},dayPadding:6};const readings=weekData.filter(d=>d.systolic&&d.diastolic&&d.systolic>0&&d.diastolic>0);return/*#__PURE__*/_jsxs(\"div\",{className:\"chart-section combined-chart \".concat(isExpanded?'expanded':''),children:[/*#__PURE__*/_jsx(\"h4\",{className:\"chart-subtitle\",children:\"Blood Pressure (Systolic/Diastolic)\"}),/*#__PURE__*/_jsx(\"div\",{className:\"bp-svg-container\",children:/*#__PURE__*/_jsxs(\"svg\",{width:\"100%\",height:\"100%\",viewBox:\"0 0 \".concat(config.width,\" \").concat(config.height),className:\"chart-svg\",children:[/*#__PURE__*/_jsx(BPRangeBackground,{config:config}),/*#__PURE__*/_jsx(GridLines,{config:config,weekDays:weekDays}),/*#__PURE__*/_jsx(DualYAxis,{config:config}),/*#__PURE__*/_jsx(XAxis,{config:config,weekDays:weekDays}),/*#__PURE__*/_jsx(CombinedDataBars,{readings:readings,config:config,onBarHover:onBarHover,onBarLeave:onBarLeave})]})})]});};const getSystolicColor=value=>{if(value<90)return'var(--chart-color-danger)';if(value<120)return'var(--chart-color-blue)';if(value<140)return'var(--chart-color-yellow)';return'var(--chart-color-orange)';};const getDiastolicColor=value=>{if(value<60)return'var(--chart-color-danger)';if(value<80)return'var(--chart-color-blue)';if(value<90)return'var(--chart-color-yellow)';return'var(--chart-color-orange)';};const bloodPressureLegendItems=[{color:'var(--chart-color-danger)',label:'Low',description:'Blood pressure below normal range'},{color:'var(--chart-color-blue)',label:'Ideal',description:'Blood pressure within ideal range'},{color:'var(--chart-color-yellow)',label:'Pre-high',description:'Blood pressure elevated but not yet high'},{color:'var(--chart-color-orange)',label:'High',description:'Blood pressure high - requires attention'}];// --- Main Component ---\nconst BloodPressureChart=_ref0=>{let{patientId,isExpanded=false,onExpand,viewMode='patient',navigation,screenshotMode=false,showThreeMonthSummaries=false}=_ref0;const{bloodPressureData,loading,error}=usePatientData(patientId,'bloodPressure');const[containerWidth,setContainerWidth]=useState(400);const[tooltipData,setTooltipData]=useState(null);const[tooltipPosition,setTooltipPosition]=useState({x:0,y:0});const[useCombinedView,setUseCombinedView]=useState(true);// New state for view toggle\nconst containerRef=useRef(null);// Use navigation from parent or fallback to internal navigation\nconst useInternalNavigation=!navigation;const internalNavigation=useChartNavigation('bloodPressure');const nav=navigation||internalNavigation;// Resize observer to track container width changes\nuseLayoutEffect(()=>{const observeContainer=()=>{if(containerRef.current){const resizeObserver=new ResizeObserver(entries=>{for(let entry of entries){const{width}=entry.contentRect;setContainerWidth(width);}});resizeObserver.observe(containerRef.current);return()=>resizeObserver.disconnect();}};const cleanup=observeContainer();return cleanup;},[]);const{start:weekStart,end:weekEnd}=nav.getDateRange();const weekData=bloodPressureData.filter(d=>{const readingDate=new Date(d.date);return readingDate>=weekStart&&readingDate<=weekEnd;});// Get 3-month data\nconst{start:startOfThreeMonths,end:endOfThreeMonths}=nav.getThreeMonthRange();const threeMonthData=bloodPressureData.filter(d=>{const readingDate=new Date(d.date);return readingDate>=startOfThreeMonths&&readingDate<=endOfThreeMonths;});const weekDays=Array.from({length:7},(_,i)=>{const d=new Date(weekStart);d.setDate(weekStart.getDate()+i);return d;});const formatDateRange=(start,end)=>{const startStr=start.toLocaleDateString('en-US',{month:'short',day:'numeric'});const endStr=end.toLocaleDateString('en-US',{month:'short',day:'numeric'});return\"\".concat(startStr,\" to \").concat(endStr);};const handleBarHover=data=>{setTooltipData(data);setTooltipPosition(data.position);};const handleBarLeave=()=>{setTooltipData(null);};// Calculate summary statistics for physician view\nlet weekSummary=null;if(weekData.length>0){const systolicReadings=weekData.filter(d=>d.systolic&&d.systolic>0).map(d=>d.systolic);const diastolicReadings=weekData.filter(d=>d.diastolic&&d.diastolic>0).map(d=>d.diastolic);const avgSystolic=systolicReadings.length>0?(systolicReadings.reduce((sum,val)=>sum+val,0)/systolicReadings.length).toFixed(0):0;const avgDiastolic=diastolicReadings.length>0?(diastolicReadings.reduce((sum,val)=>sum+val,0)/diastolicReadings.length).toFixed(0):0;const maxSystolic=systolicReadings.length>0?Math.max(...systolicReadings):0;const maxDiastolic=diastolicReadings.length>0?Math.max(...diastolicReadings):0;const getRiskCategory=(systolic,diastolic)=>{if(systolic>=135||diastolic>=85)return'High Risk';if(systolic>=121||diastolic>=80)return'Medium Risk';return'Low Risk';};const avgRisk=getRiskCategory(parseFloat(avgSystolic),parseFloat(avgDiastolic));const daysWithReadings=new Set(weekData.map(d=>d.date.toDateString())).size;weekSummary={avgSystolic,avgDiastolic,maxSystolic,maxDiastolic,avgRisk,daysWithReadings,totalReadings:weekData.length};}// Calculate 3-month summary statistics for physician view\nlet threeMonthSummary=null;if(threeMonthData.length>0){const systolicReadings=threeMonthData.filter(d=>d.systolic&&d.systolic>0).map(d=>d.systolic);const diastolicReadings=threeMonthData.filter(d=>d.diastolic&&d.diastolic>0).map(d=>d.diastolic);const avgSystolic=systolicReadings.length>0?(systolicReadings.reduce((sum,val)=>sum+val,0)/systolicReadings.length).toFixed(0):0;const avgDiastolic=diastolicReadings.length>0?(diastolicReadings.reduce((sum,val)=>sum+val,0)/diastolicReadings.length).toFixed(0):0;const maxSystolic=systolicReadings.length>0?Math.max(...systolicReadings):0;const maxDiastolic=diastolicReadings.length>0?Math.max(...diastolicReadings):0;const getRiskCategory=(systolic,diastolic)=>{if(systolic>=135||diastolic>=85)return'High Risk';if(systolic>=121||diastolic>=80)return'Medium Risk';return'Low Risk';};const avgRisk=getRiskCategory(parseFloat(avgSystolic),parseFloat(avgDiastolic));const daysWithReadings=new Set(threeMonthData.map(d=>d.date.toDateString())).size;threeMonthSummary={avgSystolic,avgDiastolic,maxSystolic,maxDiastolic,avgRisk,daysWithReadings,totalReadings:threeMonthData.length};}return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bp-chart-container \".concat(isExpanded?'expanded':''),ref:containerRef,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bp-header\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"bp-main-title\",children:\"Blood Pressure\"}),/*#__PURE__*/_jsx(\"h4\",{className:\"chart-subtitle\",children:nav.getFormattedDateRange()}),/*#__PURE__*/_jsxs(\"div\",{className:\"view-toggle\",children:[/*#__PURE__*/_jsx(\"button\",{className:\"toggle-btn \".concat(!useCombinedView?'active':''),onClick:()=>setUseCombinedView(false),children:\"Separate Charts\"}),/*#__PURE__*/_jsx(\"button\",{className:\"toggle-btn \".concat(useCombinedView?'active':''),onClick:()=>setUseCombinedView(true),children:\"Combined View\"})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"bp-charts-wrapper\",children:useCombinedView?/*#__PURE__*/_jsx(CombinedChart,{weekData:weekData,isExpanded:isExpanded,weekDays:weekDays,containerWidth:containerWidth,onBarHover:handleBarHover,onBarLeave:handleBarLeave}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Chart,{type:\"systolic\",weekData:weekData,isExpanded:isExpanded,weekDays:weekDays,containerWidth:containerWidth,onBarHover:handleBarHover,onBarLeave:handleBarLeave}),/*#__PURE__*/_jsx(Chart,{type:\"diastolic\",weekData:weekData,isExpanded:isExpanded,weekDays:weekDays,containerWidth:containerWidth,onBarHover:handleBarHover,onBarLeave:handleBarLeave})]})}),/*#__PURE__*/_jsx(Legend,{title:\"Blood Pressure Category:\",items:bloodPressureLegendItems,hide:screenshotMode}),(viewMode==='physician'||viewMode==='unified')&&weekSummary?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(InfoBox,{title:\"Blood Pressure Information\",content:\"Blood pressure is measured by two numbers: systolic and diastolic. Low blood pressure is a systolic reading below 90 mmHg and a diastolic reading below 60 mmHg. Ideal blood pressure is a systolic reading between 90 and 120 mmHg and a diastolic reading between 60 and 80 mmHg. Pre-high blood pressure is a systolic reading between 120 and 140 mmHg or a diastolic reading between 80 and 90 mmHg. High blood pressure is a systolic reading of 140 mmHg or higher or a diastolic reading of 90 mmHg or higher (Blood Pressure UK).\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"chart-summary\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"Week Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Average BP:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"stat-value\",children:[weekSummary.avgSystolic,\"/\",weekSummary.avgDiastolic,\" mmHg\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Peak BP:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"stat-value\",children:[weekSummary.maxSystolic,\"/\",weekSummary.maxDiastolic,\" mmHg\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Reading Days:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"stat-value\",children:[weekSummary.daysWithReadings,\"/7 days\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Total Readings:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:weekSummary.totalReadings})]})]})]}),showThreeMonthSummaries&&threeMonthSummary&&/*#__PURE__*/_jsxs(\"div\",{className:\"chart-summary\",children:[/*#__PURE__*/_jsx(\"h4\",{children:\"3-Month Summary\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"summary-stats\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Average BP:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"stat-value\",children:[threeMonthSummary.avgSystolic,\"/\",threeMonthSummary.avgDiastolic,\" mmHg\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Peak BP:\"}),/*#__PURE__*/_jsxs(\"span\",{className:\"stat-value\",children:[threeMonthSummary.maxSystolic,\"/\",threeMonthSummary.maxDiastolic,\" mmHg\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"stat-item\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"stat-label\",children:\"Total Readings:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"stat-value\",children:threeMonthSummary.totalReadings})]})]})]})]})]}):/*#__PURE__*/_jsx(InfoBox,{title:\"Blood Pressure Information\",content:\"Blood pressure is measured by two numbers: systolic and diastolic. Low blood pressure is a systolic reading below 90 mmHg and a diastolic reading below 60 mmHg. Ideal blood pressure is a systolic reading between 90 and 120 mmHg and a diastolic reading between 60 and 80 mmHg. Pre-high blood pressure is a systolic reading between 120 and 140 mmHg or a diastolic reading between 80 and 90 mmHg. High blood pressure is a systolic reading of 140 mmHg or higher or a diastolic reading of 90 mmHg or higher (Blood Pressure UK).\"})]}),/*#__PURE__*/_jsx(Tooltip,{isVisible:!!tooltipData,content:tooltipData&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"tooltip-title\",children:[tooltipData.type,\" Blood Pressure\"]}),tooltipData.systolic&&tooltipData.diastolic?/*#__PURE__*/_jsxs(\"div\",{className:\"tooltip-value\",children:[tooltipData.systolic,\"/\",tooltipData.diastolic,\" \",tooltipData.unit]}):/*#__PURE__*/_jsxs(\"div\",{className:\"tooltip-value\",children:[tooltipData.value,\" \",tooltipData.unit]}),/*#__PURE__*/_jsx(\"div\",{className:\"tooltip-time\",children:tooltipData.time}),/*#__PURE__*/_jsx(\"div\",{className:\"tooltip-date\",children:tooltipData.date})]}),position:tooltipPosition})]});};export default BloodPressureChart;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}